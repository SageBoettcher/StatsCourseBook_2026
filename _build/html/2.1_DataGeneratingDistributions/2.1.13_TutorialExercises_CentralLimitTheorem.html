
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Extension Work: The Central Limit Theorem (Exercises) &#8212; My Jupyter Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '2.1_DataGeneratingDistributions/2.1.13_TutorialExercises_CentralLimitTheorem';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">My Jupyter Book</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Exploring Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../1.1_DescribingData/1.1.1_Intro.html">1. Describing Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../1.1_DescribingData/1.1.2_Outcomes.html">1.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.1_DescribingData/1.1.3_MeanMedianMode.html">1.3. Mean, median and mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.1_DescribingData/1.1.4_StDevIQR.html">1.4. Standard Deviation and IQR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.1_DescribingData/1.1.5_Skew.html">1.5. Skew</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.1_DescribingData/1.1.6_Correlation.html">1.6. Correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.1_DescribingData/1.1.8_PythonIndexing.html">1.7. Python: Descriptives and Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.1_DescribingData/1.1.9_tables.html">1.8. Tables of descriptive statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.1_DescribingData/1.1.10_TutorialExercises.html">1.9. Tutorial Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1.2_DataVisualization/1.2.1_Intro.html">2. Data Visualization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../1.2_DataVisualization/1.2.3_ChoosingPlots.html">2.2. Choosing and interpreting plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.2_DataVisualization/1.2.4_snsplt.html">2.3. <code class="docutils literal notranslate"><span class="pre">Seaborn</span></code> and <code class="docutils literal notranslate"><span class="pre">Matplotlib</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.2_DataVisualization/1.2.5_histogram.html">2.4. Visualizing Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.2_DataVisualization/1.2.6_boxplot.html">2.5. Comparing Categories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.2_DataVisualization/1.2.7_scatterplot.html">2.6. 2D Data: Correlation and Pairwise Effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.2_DataVisualization/1.2.8_lineplot.html">2.7. Timeseries data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.2_DataVisualization/1.2.9_tweaks.html">2.8. Tweaking plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.2_DataVisualization/1.2.10_TutorialExercises.html">2.9. Tutorial Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1.3_DataWrangling/1.3.1_Intro.html">3. Data Wrangling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.2_Outcomes.html">3.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.3_FindOutliers.html">3.3. Locating bad datapoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.4_NaNing.html">3.4. Neutralizing bad datapoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.5_NanHandling.html">3.5. Handling NaNs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.7_CreateColumns.html">3.6. Creating new variables/columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.8_ZScoreQuantiles.html">3.7. Standardizing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.9_ReportExample.html">3.8. Preparing a report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.10_Assignment1_ModelAnswer.html">3.9. Model Client Report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.11_TutorialExercises.html">3.10. Tutorial Exercises</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistical Theory</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../2.1_Probability/2.1.1_Probability_intro.html">4. Probability</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.2_Probability_outcomes.html">4.1. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.3_KolmogorovAxioms.html">4.2. Kolmogorov Axioms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.4_Diagrams.html">4.3. Probability Diagrams</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.5_Independence.html">4.4. Statsitical Independence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.6_EventCombinations.html">4.5. Event combinations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.7_BayesTheorem.html">4.6. Bayes Theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.8_ConceptRecap.html">4.7. Concepts Recap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.9_PythonExercises.html">4.8. Python Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.10_ExtensionWork.html">4.9. Set up Python libraries</a></li>






</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="2.1.1_binomial_overallIntro.html">5. Data generating distributions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="2.1.2_binomial_intro.html">5.1. The Binomial Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.1.3_binomial_objectives.html">5.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.1.5_binomial_singlecoin.html">5.3. Simulated coin toss</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.1.6_binomial_10000reps.html">5.4. Repeat the simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.1.7_binomial_nandp.html">5.5. Changing <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(p\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="2.1.8_binomial_PMFandCDF.html">5.6. Binomial PMF and CDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.1.9_AnalyticVsNumerical.html">5.7. Analytical vs numerical approaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.1.10_NormalDistribution.html">5.8. Normal Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.1.11_NormalSimulation.html">5.9. Simulating Normal data</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.1.12_binomial_NormalApprox.html">5.10. Normal approximation to the binomial</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.1.13_TutorialExercises.html">5.11. Tutorial Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2.2_Sampling/2.2.1_sampling_intro.html">6. Sampling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.2_sampling_outcomes.html">6.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.3_sampling_overview.html">6.3. Sampling overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.4_replacement.html">6.4. Sampling with and without replacement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.5_SampleDataDistribution.html">6.5. Sample vs population</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.6_SamplingDistributionOfTheMean.html">6.6. Sampling Distribution of the Mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.7_CentralLimitTheorem.html">6.7. Central Limit Theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.8_InferenceFromSamples.html">6.8. Inference from a <em>sample</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.9_ConfidenceIntervals.html">6.9. Confidence intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.10_ConceptRecap.html">6.10. Concepts Review</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.11_TutorialExercises.html">6.11. Tutorial exercises: The Central Limit Theorem</a></li>


</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Hypothesis Testing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../3.1_PermutationTest/3.1.1_permutation_intro.html">7. Permutation Testing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.2_permutation_outcomes.html">7.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.3_HypothesisTesting.html">7.3. Hypothesis testing concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.4_OneTwoTail.html">7.4. One- and two-tailed tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.5_PermutationTypes.html">7.5. Permutation testing overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.6_functions.html">7.6. Python Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.7_permutation_paired.html">7.7. Permutation test for paired data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.8_permutation_unpaired.html">7.8. Permutation test for unpaired or independent samples data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.9_permutation_correlation.html">7.9. Permutation test for correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.10_permutation_practice.html">7.10. Permutation testing - more practice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.11_permutation_TutorialExercises.html">7.11. Tutorial exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3.2_RankBasedTests/3.2.1_classictests_intro.html">8. Classic Statistical Tests</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../3.2_RankBasedTests/3.2.2_outcomes.html">8.3. Learning Objectives: Rank-Based Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.2_RankBasedTests/3.2.3_nonpara_intro.html">8.4. Rank-based tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.2_RankBasedTests/3.2.4_MedianMean.html">8.5. Difference of medians vs difference of means</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.2_RankBasedTests/3.2.5_nonpara_MannWhitneyU.html">8.6. Rank Sum Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.2_RankBasedTests/3.2.6_nonpara_WilcoxonSignRank.html">8.7. The Wilcoxon Sign-Rank Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.2_RankBasedTests/3.2.7_spearman.html">8.8. Spearman’s Rank Correlation</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3.3_ttest/3.3.1_ttest_intro.html">9. t-Test</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../3.3_ttest/3.3.3_HypothesisTestingRecap.html">9.2. Hypothesis testing roundup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.3_ttest/3.3.4_BestFittingNormal.html">9.3. Best fitting Normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.3_ttest/3.3.5_tDistribution.html">9.4. The t distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.3_ttest/3.3.6_ttest_oneSample.html">9.5. One sample t-test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.3_ttest/3.3.7_ttest_pairedSamples.html">9.6. Paired Samples t-test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.3_ttest/3.3.8_ttest_independentSamples.html">9.7. Independent samples t-test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.3_ttest/3.3.9_HandInAssignment.html">9.8. Vacation Assignment</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3.4_Power/3.4.1_power_intro.html">10. Power analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.2_outcomes.html">10.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.3_Type1and2Errors.html">10.3. False positives and False negatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.4_EffectSize.html">10.4. Effect size (Cohen’s d)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.5_EffectSizeCorrelation.html">10.5. Effect size (Pearson’s r)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.6_PowerCorrelationSim.html">10.6. Power analysis by simulation</a></li>

<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.7_BuiltInPowerCalc.html">10.8. Power analysis with <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.8_DeterminingEffectSize.html">10.9. Knowing the effect size</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.9_SampleSizeAndPower.html">10.10. Sample size and power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.10_power_conceptCheck.html">10.11. Concepts Review</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Regression Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../4.1_Regression1/regression1_intro.html">11. Regression</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../4.1_Regression1/regression1_outcomes.html">11.1. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.1_Regression1/regression1_concepts.html">11.2. Regression Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.1_Regression1/regression1_interpretingSlope.html">11.3. Interpreting the slope and intercept, prediction and residuals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.1_Regression1/regression1_QandA.html">11.4. Regression, Covariance and Correlation Q&amp;A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.1_Regression1/regression1_prepwork.html">11.5. Regression models in Python</a></li>

<li class="toctree-l2"><a class="reference internal" href="../4.1_Regression1/regression1_TutorialExercises.html">11.7. Tutorial Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../4.2_Regression2/regression2_intro.html">12. Multivariate Analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../4.2_Regression2/regression2_concepts.html">12.2. Multivariate Analysis Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.2_Regression2/regression2_typesOfRelationship.html">12.3. Different types of multivariate relationship</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.2_Regression2/regression2_QandA.html">12.4. Multiple Regression Q &amp; A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.2_Regression2/VariableTypes.html">12.5. Handling different variable types in regression analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.2_Regression2/InteractionTerms.html">12.6. Multivariate analysis and interaction terms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.2_Regression2/regression2_TutorialExercises.html">12.7. Tutorial Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../4.3_Regression3/regression3_intro.html">13. Regression - Statistical Tests</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../4.3_Regression3/regression3_outcomes.html">13.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.3_Regression3/regression3_conceptsR2.html">13.3. Model fit: <span class="math notranslate nohighlight">\(R^2\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.3_Regression3/regression3_conceptsConditionals.html">13.4. Conditional Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.3_Regression3/regression3_conceptsSignificance.html">13.5. Statistical Significance in Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.3_Regression3/regression3_assumptions.html">13.6. Assumptions in Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.3_Regression3/regression3_prepwork.html">13.7. Assessing Regression models in Python.</a></li>

<li class="toctree-l2"><a class="reference internal" href="../4.3_Regression3/regression3_TutorialExercises.html">13.9. Tutorial Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../4.4_Regression4/regression4_intro.html">14. ANOVA</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../4.4_Regression4/regression4_outcomes.html">14.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.4_Regression4/regression4_concepts.html">14.3. ANOVA Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.4_Regression4/regression4_longhandExample.html">14.4. Longhand calculation example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.4_Regression4/regression4_equations.html">14.5. ANOVA Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.4_Regression4/regression4_KWtest.html">14.6. Kruskall-Wallis test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.4_Regression4/regression4_ANOVAregression.html">14.7. ANOVA versus Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.4_Regression4/regression4_prepwork.html">14.8. ANOVA and Kruskal-Wallis in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.4_Regression4/regression4_TutorialExercises.html">14.9. Tutorial exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../4.5_Regression5/regression5_intro.html">15. Logistic Regression</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../4.5_Regression5/regression5_outcomes.html">15.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.5_Regression5/regression5_concepts.html">15.3. Odds, logs and log odds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.5_Regression5/regression5_LogisticEquation.html">15.4. Logistic Regression Equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.5_Regression5/regression5_workedExample.html">15.5. Predicted probabilities (worked example)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.5_Regression5/regression5_prepwork.html">15.6. Logistic Regression in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.5_Regression5/regression5_TutorialExercises.html">15.7. Tutorial exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../4.6_Regression6/regression6_intro.html">16. Research Design</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../4.6_Regression6/regression6_outcomes.html">16.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.6_Regression6/regression6_concepts.html">16.3. Research Design Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.6_Regression6/regression6_causality.html">16.4. Causality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.6_Regression6/regression6_TutorialExercises.html">16.5. Tutorial exercises</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/2.1_DataGeneratingDistributions/2.1.13_TutorialExercises_CentralLimitTheorem.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Extension Work: The Central Limit Theorem (Exercises)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Extension Work: The Central Limit Theorem (Exercises)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-python-libraries">Set up Python libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-and-plot-the-data">Import and plot the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distribution-of-the-mean-when-n-is-small">Sampling distribution of the mean when <span class="math notranslate nohighlight">\(n\)</span> is small</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#n-1"><span class="math notranslate nohighlight">\(n=1\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#n-2"><span class="math notranslate nohighlight">\(n=2\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#n-3-4-5"><span class="math notranslate nohighlight">\(n = 3,4,5\)</span></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#what-do-we-mean-by-when-n-is-large">What do we mean by ‘when <span class="math notranslate nohighlight">\(n\)</span> is large’?</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#n-100"><span class="math notranslate nohighlight">\(n=100\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q-q-plot">Q-Q plot</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="extension-work-the-central-limit-theorem-exercises">
<h1>Extension Work: The Central Limit Theorem (Exercises)<a class="headerlink" href="#extension-work-the-central-limit-theorem-exercises" title="Link to this heading">#</a></h1>
<p>In these exercises we again work with the Brexdex data</p>
<p>We are going to investigate how the sampling distribution of the mean depends on <span class="math notranslate nohighlight">\(n\)</span>, the relationship between SEM and <span class="math notranslate nohighlight">\(\sqrt{n}\)</span>, and how we assess whether a distribution, such as the sampling distribution of the mean, is Normal.</p>
<section id="set-up-python-libraries">
<h2>Set up Python libraries<a class="headerlink" href="#set-up-python-libraries" title="Link to this heading">#</a></h2>
<p>As usual, run the code cell below to import the relevant Python libraries</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set-up Python libraries - you need to run this but you don&#39;t need to change it</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="kn">import</span> <span class="nn">warnings</span> 
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="import-and-plot-the-data">
<h2>Import and plot the data<a class="headerlink" href="#import-and-plot-the-data" title="Link to this heading">#</a></h2>
<p>Let’s remind ourselves of the dataset we are working with</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">UKBrexdex</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/jillxoreilly/StatsCourseBook_2024/main/data/UKBrexdex.csv&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">UKBrexdex</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">101</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;score on BrexDex&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;frequency&#39;)
</pre></div>
</div>
<img alt="../_images/a47163e1c385e39ce24ed0fd8b021bb293a39d45240dec593c699cc35a7c00f6.png" src="../_images/a47163e1c385e39ce24ed0fd8b021bb293a39d45240dec593c699cc35a7c00f6.png" />
</div>
</div>
<p>How would you describe this data?</p>
<ul>
<li> write some text, including descritive statatistics, to describe the distribution of Brexdex scores in the UK population
</ul></section>
<section id="sampling-distribution-of-the-mean-when-n-is-small">
<h2>Sampling distribution of the mean when <span class="math notranslate nohighlight">\(n\)</span> is small<a class="headerlink" href="#sampling-distribution-of-the-mean-when-n-is-small" title="Link to this heading">#</a></h2>
<p>Let’s start by simulating what the sampling distribution of the mean looks like for small values of <span class="math notranslate nohighlight">\(n\)</span> - starting with <span class="math notranslate nohighlight">\(n=1\)</span></p>
<section id="n-1">
<h3><span class="math notranslate nohighlight">\(n=1\)</span><a class="headerlink" href="#n-1" title="Link to this heading">#</a></h3>
<p>Write some code to draw 10,000 samples with n=1, obtain the mean of each sample, and plot the means.</p>
<p><b><i>Think</i></b></p>
<ul>
    <li> Before you run it, think: what will this 'sampling distribution of the mean' look like?
</ul><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here!</span>
</pre></div>
</div>
</div>
</div>
<p>In fact when <span class="math notranslate nohighlight">\(n=1\)</span>, the sample mean is simply the value of the (one) person in the sample’s score, so the sampling distribution of the mean is exactly the sample data distribution</p>
</section>
<section id="n-2">
<h3><span class="math notranslate nohighlight">\(n=2\)</span><a class="headerlink" href="#n-2" title="Link to this heading">#</a></h3>
<p>Write some code to draw 10,000 samples with n=2, obtain the mean of each sample, and plot the means.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code here!</span>
</pre></div>
</div>
</div>
</div>
<p>Hopefully you have noticed a middle peak emerging.</p>
<p><b><i>Think</i></b>-</p>
<p>A simple summary of the Brexdex distribution is that people are either pre-Brexit (belonging to the lower mode of the distribution, the hump of scores below 50%), or they are against Brexit (belonging to the upper mode).</p>
<p>If we draw a sample of <span class="math notranslate nohighlight">\(n=2\)</span>, there are four possible outomes:</p>
<ol>
    <li> pro-pro
    <li> pro-against
    <li> against-pro
    <li> against-against
</ol>
<p>Case 1 yeilds low scores, case 4 yeilds high scores, and cases 2 and 3 yeild intermediate scores.</p>
<p>How does this relate to the simulated sampling distribution of the mean you plotted?</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="n-3-4-5">
<h1><span class="math notranslate nohighlight">\(n = 3,4,5\)</span><a class="headerlink" href="#n-3-4-5" title="Link to this heading">#</a></h1>
<p>As <span class="math notranslate nohighlight">\(n\)</span> increases, we rapidly see a unimodal, bell-curve-like shape emerging</p>
<p>Write some code to simulate the sampling distribution of the mean for 10,000 samples each of <span class="math notranslate nohighlight">\(n=3,4,5\)</span> and plot a histogram of the sample means for each value of <span class="math notranslate nohighlight">\(n\)</span>. Organise these plots as subplots next to or above each other (you decide which is more informative)</p>
<p>You can find an example that does similar, using a doulbe <tt>for</tt>-loop, in one of the preparatory workbooks for this week</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="what-do-we-mean-by-when-n-is-large">
<h1>What do we mean by ‘when <span class="math notranslate nohighlight">\(n\)</span> is large’?<a class="headerlink" href="#what-do-we-mean-by-when-n-is-large" title="Link to this heading">#</a></h1>
<p>The Central Limit Theorem states that the sampling distribution of the mean is estimated by <span class="math notranslate nohighlight">\(\mathcal{N}(\bar{x},\frac{s}{\sqrt{n}})\)</span> when <span class="math notranslate nohighlight">\(n\)</span> is large</p>
<p>How large is large enough?</p>
<p>A good rule of thumb is that the Central Limit Theorem applies for <span class="math notranslate nohighlight">\(n&gt;50\)</span>, and a larger <span class="math notranslate nohighlight">\(n\)</span> is required for a roughly normal sampling distribution when the data distribution is grossly non-normal (such as the bimodal Brexdex distribution).</p>
<p>In reality, the normal distribution becomes a closer and closer fit tot the sampling distribution of the mean as <span class="math notranslate nohighlight">\(n\)</span> gets larger</p>
<section id="n-100">
<h2><span class="math notranslate nohighlight">\(n=100\)</span><a class="headerlink" href="#n-100" title="Link to this heading">#</a></h2>
<p>Let’s start with a value of <span class="math notranslate nohighlight">\(n\)</span> for which the central limit theorem should definitely apply, <span class="math notranslate nohighlight">\(n=100\)</span></p>
<p>Now, we work out the mean and SEM that would be predicted for the sampling distribution of the mean, if the central limit theorem applied.</p>
<p>Finally we compare the predicted normal distribution to the simulated sampling distribution of the mean in a plot</p>
<p><em><strong>Note -</strong></em>
The code to get the normal curve and histogram to match in scale is a bit fiddly, don’t worry about the details!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first simulate the sampling distribution of the mean for 10,000 samples</span>
<span class="n">nSamples</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">m</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">nSamples</span><span class="p">)</span> <span class="c1"># make an array to store the means</span>
<span class="n">binwidth</span><span class="o">=</span><span class="mf">0.1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nSamples</span><span class="p">):</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">UKBrexdex</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">],</span> <span class="n">n</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">sample</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="n">binwidth</span><span class="p">))</span>
 
<span class="c1"># now work out the expected normal distribution</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">UKBrexdex</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">UKBrexdex</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">SEM</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="n">binwidth</span><span class="p">)</span> <span class="c1"># x axis values - you may wat to change these once you have tried plotting it</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">SEM</span><span class="p">)</span>
<span class="n">freq</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">nSamples</span><span class="o">*</span><span class="n">binwidth</span> <span class="c1"># exected frequency in each ibn is probability of the bin * total nSamples * bin width</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">freq</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;sample mean&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/be96f35eed7c26c6e107cc057f4435aa5e046099c7dcf6c07733c6a4a0a6d28e.png" src="../_images/be96f35eed7c26c6e107cc057f4435aa5e046099c7dcf6c07733c6a4a0a6d28e.png" />
</div>
</div>
<p>This is clearly quite a good fit.</p>
<p>Now try changing <span class="math notranslate nohighlight">\(n\)</span>, in the code block above, to <span class="math notranslate nohighlight">\(n=4\)</span> (<b><i>hint:</b></i> change the histogram bins and x-axis values to  <tt>np.arange(0,100,binwidth)</tt>, and change <tt>binwidth</tt> to 1)</p>
<p>Hopefully, you can see that although the histogram on its own looked quite normal, it is actually not a great fit to the normal distribution we would expect if the Central Limit Theorem applied - the peak is too flat and there are fewer sample means out in the tails than we would expect - the distribution looks like a piece of Toblerone</p>
<img src= "https://raw.githubusercontent.com/jillxoreilly/StatsCourseBook/main/images/toblerone.png" width="30%"  />
</section>
<section id="q-q-plot">
<h2>Q-Q plot<a class="headerlink" href="#q-q-plot" title="Link to this heading">#</a></h2>
<p>The differences in the peak and tails of the distribution can be hard to spot on a histogram/Normal plot as above.</p>
<p>A type of plot designed to make these clearer exists - it is called a Q-Q (quantile-quantile) plot. In the Q-Q plot, we plot the quantiles of the data distribution (in this case our 10,000 simulated sample means) against the quantiles of the normal distribution.</p>
<p>If our data distribution was normal, the points would all fall on a straight line, but here we see the deviation at the tails of the distribution, reflecting the difference between the triangular tails of the simulated sampling distribution as opposed to the finely tapered tails of the normal distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">probplot</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">plt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/161630c35cb2eb9ef963e8b011cda4bf0c32b4f09cb28c7cb3466a3b836e3435.png" src="../_images/161630c35cb2eb9ef963e8b011cda4bf0c32b4f09cb28c7cb3466a3b836e3435.png" />
</div>
</div>
<ul>
    <li>Try changing <i>n</i> back to some larger value such as 10 ot 100 in the code block above and remaking the Q-Q plot. 
</ul>
<p>You should see the tails of the sampling distribution (in both he histogram and the Q-Q plot) start to match the normal distribution</p>
<ul>
    <li>Try setting <i>n=2</i> in the code block above and remaking the Q-Q plot. 
</ul>
<p>You should see the funny three-peak histogram - how is the shape of the histogram reflected in the Q-Q plot?</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./2.1_DataGeneratingDistributions"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Extension Work: The Central Limit Theorem (Exercises)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-python-libraries">Set up Python libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-and-plot-the-data">Import and plot the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distribution-of-the-mean-when-n-is-small">Sampling distribution of the mean when <span class="math notranslate nohighlight">\(n\)</span> is small</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#n-1"><span class="math notranslate nohighlight">\(n=1\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#n-2"><span class="math notranslate nohighlight">\(n=2\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#n-3-4-5"><span class="math notranslate nohighlight">\(n = 3,4,5\)</span></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#what-do-we-mean-by-when-n-is-large">What do we mean by ‘when <span class="math notranslate nohighlight">\(n\)</span> is large’?</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#n-100"><span class="math notranslate nohighlight">\(n=100\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q-q-plot">Q-Q plot</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>