
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tutorial Exercises: non-parametric tests &#8212; My Jupyter Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '3.2_RankBasedTests/3.2.8_TutorialExercises_TutorNotes';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">My Jupyter Book</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Preparation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../0.1_PrepWork/MT_wk0_intro.html">1. Preparatory Work</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../0.1_PrepWork/MT_wk0_datacamp.html">1.2. Datacamp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../0.1_PrepWork/MT_wk0_JupyterLab.html">1.3. Using Anaconda and JupyterLab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../0.1_PrepWork/MT_wk0_Colab.html">1.4. Using Google Colab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../0.1_PrepWork/MT_wk0_For.html">1.5. The FOR loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../0.1_PrepWork/MT_wk0_ForIf.html">1.6. FOR loop with IF statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../0.1_PrepWork/MT_wk0_random.html">1.7. Simulating a random process</a></li>

<li class="toctree-l2"><a class="reference internal" href="../0.1_PrepWork/MT_wk0_ChatGPT.html">1.9. ChatGPT</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exploring Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../1.1_DescribingData/1.1.1_Intro.html">2. Describing Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../1.1_DescribingData/1.1.2_Outcomes.html">2.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.1_DescribingData/1.1.3_MeanMedianMode.html">2.3. Mean, median and mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.1_DescribingData/1.1.4_StDevIQR.html">2.4. Standard Deviation and IQR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.1_DescribingData/1.1.5_Skew.html">2.5. Skew</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.1_DescribingData/1.1.6_Correlation.html">2.6. Correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.1_DescribingData/1.1.8_PythonIndexing.html">2.7. Python: Descriptives and Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.1_DescribingData/1.1.9_tables.html">2.8. Tables of descriptive statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.1_DescribingData/1.1.10_TutorialExercises.html">2.9. Tutorial Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1.2_DataVisualization/1.2.1_Intro.html">3. Data Visualization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../1.2_DataVisualization/1.2.3_ChoosingPlots.html">3.2. Choosing and interpreting plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.2_DataVisualization/1.2.4_snsplt.html">3.3. <code class="docutils literal notranslate"><span class="pre">Seaborn</span></code> and <code class="docutils literal notranslate"><span class="pre">Matplotlib</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.2_DataVisualization/1.2.5_histogram.html">3.4. Visualizing Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.2_DataVisualization/1.2.6_boxplot.html">3.5. Comparing Categories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.2_DataVisualization/1.2.7_scatterplot.html">3.6. 2D Data: Correlation and Pairwise Effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.2_DataVisualization/1.2.8_lineplot.html">3.7. Timeseries data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.2_DataVisualization/1.2.9_tweaks.html">3.8. Tweaking plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.2_DataVisualization/1.2.10_TutorialExercises.html">3.9. Tutorial Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1.3_DataWrangling/1.3.1_Intro.html">4. Data Wrangling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.2_Outcomes.html">4.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.3_FindOutliers.html">4.3. Locating bad datapoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.4_NaNing.html">4.4. Neutralizing bad datapoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.5_NanHandling.html">4.5. Handling NaNs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.7_CreateColumns.html">4.6. Creating new variables/columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.8_ZScoreQuantiles.html">4.7. Standardizing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.9_ReportExample.html">4.8. Preparing a report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.10_Assignment1_ModelAnswer.html">4.9. Model Client Report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1.3_DataWrangling/1.3.11_TutorialExercises.html">4.10. Tutorial Exercises</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistical Theory</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../2.1_Probability/2.1.1_Probability_intro.html">5. Probability</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.2_Probability_outcomes.html">5.1. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.3_KolmogorovAxioms.html">5.2. Kolmogorov Axioms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.4_Diagrams.html">5.3. Probability Diagrams</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.5_Independence.html">5.4. Statsitical Independence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.6_EventCombinations.html">5.5. Event combinations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.7_BayesTheorem.html">5.6. Bayes Theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.8_ConceptRecap.html">5.7. Concepts Recap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.9_PythonExercises.html">5.8. Python Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_Probability/2.1.10_ExtensionWork.html">5.9. Set up Python libraries</a></li>






</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2.1_DataGeneratingDistributions/2.1.1_binomial_overallIntro.html">6. Data generating distributions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../2.1_DataGeneratingDistributions/2.1.2_binomial_intro.html">6.1. The Binomial Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_DataGeneratingDistributions/2.1.3_binomial_objectives.html">6.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_DataGeneratingDistributions/2.1.5_binomial_singlecoin.html">6.3. Simulated coin toss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_DataGeneratingDistributions/2.1.6_binomial_10000reps.html">6.4. Repeat the simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_DataGeneratingDistributions/2.1.7_binomial_nandp.html">6.5. Changing <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(p\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_DataGeneratingDistributions/2.1.8_binomial_PMFandCDF.html">6.6. Binomial PMF and CDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_DataGeneratingDistributions/2.1.9_AnalyticVsNumerical.html">6.7. Analytical vs numerical approaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_DataGeneratingDistributions/2.1.10_NormalDistribution.html">6.8. Normal Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_DataGeneratingDistributions/2.1.11_NormalSimulation.html">6.9. Simulating Normal data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_DataGeneratingDistributions/2.1.12_binomial_NormalApprox.html">6.10. Normal approximation to the binomial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.1_DataGeneratingDistributions/2.1.13_TutorialExercises.html">6.11. Tutorial Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2.2_Sampling/2.2.1_sampling_intro.html">7. Sampling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.2_sampling_outcomes.html">7.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.3_sampling_overview.html">7.3. Sampling overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.4_replacement.html">7.4. Sampling with and without replacement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.5_SampleDataDistribution.html">7.5. Sample vs population</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.6_SamplingDistributionOfTheMean.html">7.6. Sampling Distribution of the Mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.7_CentralLimitTheorem.html">7.7. Central Limit Theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.8_InferenceFromSamples.html">7.8. Inference from a <em>sample</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.9_ConfidenceIntervals.html">7.9. Confidence intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.10_ConceptRecap.html">7.10. Concepts Review</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2.2_Sampling/2.2.11_TutorialExercises.html">7.11. Tutorial exercises: The Central Limit Theorem</a></li>


</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Hypothesis Testing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../3.1_PermutationTest/3.1.1_permutation_intro.html">8. Permutation Testing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.2_permutation_outcomes.html">8.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.3_HypothesisTesting.html">8.3. Hypothesis testing concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.4_OneTwoTail.html">8.4. One- and two-tailed tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.5_PermutationTypes.html">8.5. Permutation testing overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.6_functions.html">8.6. Python Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.7_permutation_paired.html">8.7. Permutation test for paired data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.8_permutation_unpaired.html">8.8. Permutation test for unpaired or independent samples data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.9_permutation_correlation.html">8.9. Permutation test for correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.10_permutation_practice.html">8.10. Permutation testing - more practice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.1_PermutationTest/3.1.11_permutation_TutorialExercises.html">8.11. Tutorial exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="3.2.1_classictests_intro.html">9. Rank-Based Tests</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="3.2.2_outcomes.html">9.3. Learning Objectives: Rank-Based Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.2.3_nonpara_intro.html">9.4. Rank-based tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.2.4_MedianMean.html">9.5. Difference of medians vs difference of means</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.2.5_nonpara_MannWhitneyU.html">9.6. Rank Sum Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.2.6_nonpara_WilcoxonSignRank.html">9.7. The Wilcoxon Sign-Rank Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.2.7_spearman.html">9.8. Spearman’s Rank Correlation</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3.3_ttest/3.3.1_ttest_intro.html">10. t-Test</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../3.3_ttest/3.3.3_HypothesisTestingRecap.html">10.2. Hypothesis testing roundup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.3_ttest/3.3.4_BestFittingNormal.html">10.3. Best fitting Normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.3_ttest/3.3.5_tDistribution.html">10.4. The t distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.3_ttest/3.3.6_ttest_oneSample.html">10.5. One sample t-test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.3_ttest/3.3.7_ttest_pairedSamples.html">10.6. Paired Samples t-test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.3_ttest/3.3.8_ttest_independentSamples.html">10.7. Independent samples t-test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.3_ttest/3.3.9_HandInAssignment.html">10.8. Vacation Assignment</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3.4_Power/3.4.1_power_intro.html">11. Power analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.2_outcomes.html">11.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.3_Type1and2Errors.html">11.3. False positives and False negatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.4_EffectSize.html">11.4. Effect size (Cohen’s d)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.5_EffectSizeCorrelation.html">11.5. Effect size (Pearson’s r)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.6_PowerCorrelationSim.html">11.6. Power analysis by simulation</a></li>

<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.7_BuiltInPowerCalc.html">11.8. Power analysis with <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.8_DeterminingEffectSize.html">11.9. Knowing the effect size</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.9_SampleSizeAndPower.html">11.10. Sample size and power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3.4_Power/3.4.10_power_conceptCheck.html">11.11. Concepts Review</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Regression Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../4.1_Regression1/regression1_intro.html">12. Regression</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../4.1_Regression1/regression1_outcomes.html">12.1. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.1_Regression1/regression1_concepts.html">12.2. Regression Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.1_Regression1/regression1_interpretingSlope.html">12.3. Interpreting the slope and intercept, prediction and residuals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.1_Regression1/regression1_QandA.html">12.4. Regression, Covariance and Correlation Q&amp;A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.1_Regression1/regression1_prepwork.html">12.5. Regression models in Python</a></li>

<li class="toctree-l2"><a class="reference internal" href="../4.1_Regression1/regression1_TutorialExercises.html">12.7. Tutorial Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../4.2_Regression2/regression2_intro.html">13. Multivariate Analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../4.2_Regression2/regression2_concepts.html">13.2. Multivariate Analysis Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.2_Regression2/regression2_typesOfRelationship.html">13.3. Different types of multivariate relationship</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.2_Regression2/regression2_QandA.html">13.4. Multiple Regression Q &amp; A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.2_Regression2/VariableTypes.html">13.5. Handling different variable types in regression analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.2_Regression2/InteractionTerms.html">13.6. Multivariate analysis and interaction terms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.2_Regression2/regression2_TutorialExercises.html">13.7. Tutorial Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../4.3_Regression3/regression3_intro.html">14. Regression - Statistical Tests</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../4.3_Regression3/regression3_outcomes.html">14.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.3_Regression3/regression3_conceptsR2.html">14.3. Model fit: <span class="math notranslate nohighlight">\(R^2\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.3_Regression3/regression3_conceptsConditionals.html">14.4. Conditional Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.3_Regression3/regression3_conceptsSignificance.html">14.5. Statistical Significance in Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.3_Regression3/regression3_assumptions.html">14.6. Assumptions in Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.3_Regression3/regression3_prepwork.html">14.7. Assessing Regression models in Python.</a></li>

<li class="toctree-l2"><a class="reference internal" href="../4.3_Regression3/regression3_TutorialExercises.html">14.9. Tutorial Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../4.4_Regression4/regression4_intro.html">15. ANOVA</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../4.4_Regression4/regression4_outcomes.html">15.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.4_Regression4/regression4_concepts.html">15.3. ANOVA Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.4_Regression4/regression4_longhandExample.html">15.4. Longhand calculation example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.4_Regression4/regression4_equations.html">15.5. ANOVA Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.4_Regression4/regression4_KWtest.html">15.6. Kruskall-Wallis test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.4_Regression4/regression4_ANOVAregression.html">15.7. ANOVA versus Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.4_Regression4/regression4_prepwork.html">15.8. ANOVA and Kruskal-Wallis in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.4_Regression4/regression4_TutorialExercises.html">15.9. Tutorial exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../4.5_Regression5/regression5_intro.html">16. Logistic Regression</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../4.5_Regression5/regression5_outcomes.html">16.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.5_Regression5/regression5_concepts.html">16.3. Odds, logs and log odds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.5_Regression5/regression5_LogisticEquation.html">16.4. Logistic Regression Equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.5_Regression5/regression5_workedExample.html">16.5. Predicted probabilities (worked example)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.5_Regression5/regression5_prepwork.html">16.6. Logistic Regression in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.5_Regression5/regression5_TutorialExercises.html">16.7. Tutorial exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../4.6_Regression6/regression6_intro.html">17. Research Design</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../4.6_Regression6/regression6_outcomes.html">17.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.6_Regression6/regression6_concepts.html">17.3. Research Design Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.6_Regression6/regression6_causality.html">17.4. Causality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4.6_Regression6/regression6_TutorialExercises.html">17.5. Tutorial exercises</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/3.2_RankBasedTests/3.2.8_TutorialExercises_TutorNotes.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tutorial Exercises: non-parametric tests</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-python-libraries">Set up Python libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#whose-peaches-are-heavier">1. Whose peaches are heavier?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#iq-and-vitamins">2. IQ and vitamins</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#socks">3. Socks</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tutorial-exercises-non-parametric-tests">
<h1>Tutorial Exercises: non-parametric tests<a class="headerlink" href="#tutorial-exercises-non-parametric-tests" title="Link to this heading">#</a></h1>
<p><font color='red'> Hi tutors, this week the students should practice running the rank-sum and sign-rank tests. They can also re-practice permutation tests. The last exercise is designed to emphasise the key conceptual learning for the week, which is that the (null) distribution of the test statistic depends on the sample distribution (in all cases), but how much information we retain about the sample distribution is different between tests: in permutation tests we keep the sample sizes, and the overall data distribution (plus any pairings); in the rank-based test we keep the sample sizes and any pairings, but replace the actual data with their ranks. One consequence of this is that rank-based tests are less sensitive to outliers in the sample. You may wish to discuss with students whether this is always a good thing (!) with reference to the previous material (in the section on data wrangling) about sources of outliers - ie some outliers are noise (hopefully, many of these are reomved in the data wrangling process), and some are real but unusual data.</p>
<p>Here are some exercises on comparing groups of data (medians or means) using rank-based non-parametric tests, or permutation tests</font></p>
<section id="set-up-python-libraries">
<h2>Set up Python libraries<a class="headerlink" href="#set-up-python-libraries" title="Link to this heading">#</a></h2>
<p>As usual, run the code cell below to import the relevant Python libraries</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set-up Python libraries - you need to run this but you don&#39;t need to change it</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="kn">import</span> <span class="nn">warnings</span> 
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="whose-peaches-are-heavier">
<h2>1. Whose peaches are heavier?<a class="headerlink" href="#whose-peaches-are-heavier" title="Link to this heading">#</a></h2>
<img src="https://raw.githubusercontent.com/jillxoreilly/StatsCourseBook/main/images/peaches.png" width=30% alt="There should be a picture of some peaches here" >
<p>Mr Robinson’s juice factory buys peaches from farmers by the tray. Each tray contains 50 peaches. Farmer McDonald claims that this is unfair as his peaches are juicier and therefore weigh more than the peaches of his rival, Mr McGregor.</p>
<p>Mr Robinson weighs eight trays of Farmer McDonald’s peaches and 8 trays of Mr McGregor’s peaches.</p>
<p>Investigate whether McDonald’s claim is justified by testing for a difference in weight between McDonald and McGregor’s peaches using a non-parametric (rank-based) test.</p>
<p>a) Load the data into a Pandas dataframe</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">peaches</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/jillxoreilly/StatsCourseBook_2024/main/data/peaches.csv&#39;</span><span class="p">)</span>
<span class="n">peaches</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>McGregor</th>
      <th>MacDonald</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7.867</td>
      <td>8.289</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7.637</td>
      <td>7.972</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.652</td>
      <td>8.237</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7.772</td>
      <td>7.789</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7.510</td>
      <td>7.345</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7.743</td>
      <td>7.861</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7.356</td>
      <td>7.779</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7.944</td>
      <td>7.974</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>b) Plot the data and comment.</p>
<p>A Kernel desity estimate plot (to show the distribution) and rug plot (to show individual data points) would be a good choice here. You should comment on the data distribution</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code here to plot the data</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">peaches</span><span class="o">.</span><span class="n">McGregor</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">peaches</span><span class="o">.</span><span class="n">McGregor</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">peaches</span><span class="o">.</span><span class="n">MacDonald</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">peaches</span><span class="o">.</span><span class="n">MacDonald</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/40c3f76af4511ae5b709d794c80c1bc42c313ab1b12789cdbad3280c691d152c.png" src="../_images/40c3f76af4511ae5b709d794c80c1bc42c313ab1b12789cdbad3280c691d152c.png" />
</div>
</div>
<p>c) Conduct an appropriate rank-based non-parametric test of Farmer McDonald’s claim</p>
<ul class="simple">
<li><p>State your hypotheses</p></li>
<li><p>State relevant descriptive statistics</p></li>
<li><p>Carry out the test using the built in function from <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> with appropriate option choices</p></li>
<li><p>State your conclusions</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">peaches</span><span class="o">.</span><span class="n">MacDonald</span><span class="p">,</span> <span class="n">peaches</span><span class="o">.</span><span class="n">McGregor</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;greater&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MannwhitneyuResult(statistic=50.0, pvalue=0.032478632478632474)
</pre></div>
</div>
</div>
</div>
<p>d) Conduct a permutation test of the same claim</p>
<ul class="simple">
<li><p>State your hypotheses</p></li>
<li><p>State relevant descriptive statistics</p></li>
<li><p>Carry out the test using the built in function from <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> with appropriate option choices</p></li>
<li><p>State your conclusions</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dMeans</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>


<span class="n">stats</span><span class="o">.</span><span class="n">permutation_test</span><span class="p">((</span><span class="n">peaches</span><span class="o">.</span><span class="n">MacDonald</span><span class="p">,</span> <span class="n">peaches</span><span class="o">.</span><span class="n">McGregor</span><span class="p">),</span> <span class="n">dMeans</span><span class="p">,</span> <span class="n">permutation_type</span><span class="o">=</span><span class="s1">&#39;independent&#39;</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;greater&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PermutationTestResult(statistic=0.22062500000000007, pvalue=0.0422, null_distribution=array([-0.005125,  0.089875, -0.174875, ..., -0.078125,  0.157625,
        0.089875]))
</pre></div>
</div>
</div>
</div>
</section>
<section id="iq-and-vitamins">
<h2>2. IQ and vitamins<a class="headerlink" href="#iq-and-vitamins" title="Link to this heading">#</a></h2>
<img src="https://raw.githubusercontent.com/jillxoreilly/StatsCourseBook/main/images/vitamins.jpg" width=50% alt="There should be a picture of some vitamin pills here" >
<p>The VitalVit company claim that after taking their VitalVit supplement, IQ is increased.</p>
<p>They run a trial in which 22 participants complete a baseline IQ test, then take VitalVit for six weeks, then complete another IQ test.</p>
<p>a) What kind of design is this.</p>
<p>&lt; your answer here &gt;</p>
<p>repeated measures</p>
<p>b) What are the advantages and possible disadvantages of this type of design? Should the company have done something different or additional to rule out confounding factors?</p>
<p>&lt; your answer here &gt;</p>
<p>Main disadvantage is order effects (improvement on 2nd test could simply be due to practice)</p>
<p>They should have counterbalanced the order or used separate groups of people</p>
<p>c) Load the data into a Pandas dataframe</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vitamin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/jillxoreilly/StatsCourseBook_2024/main/data/vitalVit.csv&#39;</span><span class="p">)</span>
<span class="n">vitamin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID_code</th>
      <th>before</th>
      <th>after</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>688870</td>
      <td>82.596</td>
      <td>83.437</td>
    </tr>
    <tr>
      <th>1</th>
      <td>723650</td>
      <td>117.200</td>
      <td>119.810</td>
    </tr>
    <tr>
      <th>2</th>
      <td>445960</td>
      <td>85.861</td>
      <td>83.976</td>
    </tr>
    <tr>
      <th>3</th>
      <td>708780</td>
      <td>125.640</td>
      <td>127.680</td>
    </tr>
    <tr>
      <th>4</th>
      <td>109960</td>
      <td>96.751</td>
      <td>99.103</td>
    </tr>
    <tr>
      <th>5</th>
      <td>968530</td>
      <td>105.680</td>
      <td>106.890</td>
    </tr>
    <tr>
      <th>6</th>
      <td>164930</td>
      <td>142.410</td>
      <td>145.550</td>
    </tr>
    <tr>
      <th>7</th>
      <td>744410</td>
      <td>109.650</td>
      <td>109.320</td>
    </tr>
    <tr>
      <th>8</th>
      <td>499380</td>
      <td>128.210</td>
      <td>125.110</td>
    </tr>
    <tr>
      <th>9</th>
      <td>290560</td>
      <td>84.773</td>
      <td>87.249</td>
    </tr>
    <tr>
      <th>10</th>
      <td>780690</td>
      <td>110.470</td>
      <td>112.650</td>
    </tr>
    <tr>
      <th>11</th>
      <td>660820</td>
      <td>100.870</td>
      <td>99.074</td>
    </tr>
    <tr>
      <th>12</th>
      <td>758780</td>
      <td>94.117</td>
      <td>95.951</td>
    </tr>
    <tr>
      <th>13</th>
      <td>363320</td>
      <td>96.952</td>
      <td>96.801</td>
    </tr>
    <tr>
      <th>14</th>
      <td>638840</td>
      <td>86.280</td>
      <td>87.669</td>
    </tr>
    <tr>
      <th>15</th>
      <td>483930</td>
      <td>89.413</td>
      <td>94.379</td>
    </tr>
    <tr>
      <th>16</th>
      <td>102800</td>
      <td>85.283</td>
      <td>88.316</td>
    </tr>
    <tr>
      <th>17</th>
      <td>581620</td>
      <td>94.477</td>
      <td>96.300</td>
    </tr>
    <tr>
      <th>18</th>
      <td>754980</td>
      <td>90.649</td>
      <td>94.158</td>
    </tr>
    <tr>
      <th>19</th>
      <td>268960</td>
      <td>103.190</td>
      <td>104.300</td>
    </tr>
    <tr>
      <th>20</th>
      <td>314040</td>
      <td>92.880</td>
      <td>94.556</td>
    </tr>
    <tr>
      <th>21</th>
      <td>324960</td>
      <td>97.843</td>
      <td>97.969</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>d) Plot the data and comment.
A scatterplot would be a good choice as these are paired data.
You could add the line of equality (line x=y) to the graph so we can see whether most people score higer on the IQ test before or after taking VitalVit</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here for a scatter plot.</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vitamin</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;after&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">80</span><span class="p">,</span><span class="mi">150</span><span class="p">],[</span><span class="mi">80</span><span class="p">,</span><span class="mi">150</span><span class="p">],</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/db7e337dfddee4a480f008f9bb81a42bcf845cb529f42eb3363424a2f22970f1.png" src="../_images/db7e337dfddee4a480f008f9bb81a42bcf845cb529f42eb3363424a2f22970f1.png" />
</div>
</div>
<p>e) Conduct a suitable rank-based non-parametric test of VitalVit’s claim</p>
<ul class="simple">
<li><p>State your hypotheses</p></li>
<li><p>State relevant descriptive statistics</p></li>
<li><p>Carry out the test using the built in function from <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> with appropriate option choices</p></li>
<li><p>State your conclusions</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">wilcoxon</span><span class="p">(</span><span class="n">vitamin</span><span class="o">.</span><span class="n">after</span><span class="p">,</span> <span class="n">vitamin</span><span class="o">.</span><span class="n">before</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;greater&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WilcoxonResult(statistic=208.0, pvalue=0.003324747085571289)
</pre></div>
</div>
</div>
</div>
<p>f) Conduct a suitable permutation test of VitalVit’s claim</p>
<ul class="simple">
<li><p>State your hypotheses</p></li>
<li><p>State relevant descriptive statistics</p></li>
<li><p>Carry out the test using the built in function from <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> with appropriate option choices</p></li>
<li><p>State your conclusions</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mDiff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>

<span class="n">stats</span><span class="o">.</span><span class="n">permutation_test</span><span class="p">((</span><span class="n">vitamin</span><span class="o">.</span><span class="n">after</span><span class="p">,</span> <span class="n">vitamin</span><span class="o">.</span><span class="n">before</span><span class="p">),</span> <span class="n">mDiff</span><span class="p">,</span> <span class="n">permutation_type</span><span class="o">=</span><span class="s1">&#39;samples&#39;</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;greater&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PermutationTestResult(statistic=1.320590909090907, pvalue=0.0027, null_distribution=array([-0.13668182,  0.18477273,  0.1725    , ..., -0.4665    ,
        0.14468182, -0.8385    ]))
</pre></div>
</div>
</div>
</div>
</section>
<section id="socks">
<h2>3. Socks<a class="headerlink" href="#socks" title="Link to this heading">#</a></h2>
<p>In the section on permutation testing, we introduced a dataset on sock ownership (number of pairs of socks owned for 14 husband-wife couples. We noticed that when using a permutation test for difference of means, the null distribution of the difference of means was strongly affected by the presences of an outlier:</p>
<ul class="simple">
<li><p>in one couple the husband owned about 30 more pairs of socks than the wife</p></li>
<li><p>wheter the difference of means in each permutation was positive or negative depended disproportionately on whether this couple were ‘flipped’ or not in that particular permutation</p></li>
</ul>
<p>Let’s compare the use of the rank-based (Wilcoxon’s Sign-Rank test) test with the permutation test for the mean difference.</p>
<p><strong>a. Load the data (done for you)</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">socks</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/jillxoreilly/StatsCourseBook_2024/main/data/socks.csv&#39;</span><span class="p">)</span>
<span class="n">socks</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Husband</th>
      <th>Wife</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17</td>
      <td>13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>48</td>
      <td>20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>28</td>
      <td>25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>23</td>
      <td>18</td>
    </tr>
    <tr>
      <th>5</th>
      <td>16</td>
      <td>14</td>
    </tr>
    <tr>
      <th>6</th>
      <td>18</td>
      <td>13</td>
    </tr>
    <tr>
      <th>7</th>
      <td>34</td>
      <td>26</td>
    </tr>
    <tr>
      <th>8</th>
      <td>27</td>
      <td>22</td>
    </tr>
    <tr>
      <th>9</th>
      <td>22</td>
      <td>14</td>
    </tr>
    <tr>
      <th>10</th>
      <td>12</td>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>13</td>
      <td>17</td>
    </tr>
    <tr>
      <th>12</th>
      <td>22</td>
      <td>21</td>
    </tr>
    <tr>
      <th>13</th>
      <td>15</td>
      <td>16</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>b. Plot the data (done for you)</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">socks</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">socks</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6c3cfd1d39f96804e55f04bbf300cb5ea1129494fe7aef076baca0c16c30e855.png" src="../_images/6c3cfd1d39f96804e55f04bbf300cb5ea1129494fe7aef076baca0c16c30e855.png" />
</div>
</div>
<p><strong>c. Carry out a suitable rank-based non-parametric test of the hypothesis that men own more socks than women</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">wilcoxon</span><span class="p">(</span><span class="n">socks</span><span class="o">.</span><span class="n">Husband</span><span class="p">,</span> <span class="n">socks</span><span class="o">.</span><span class="n">Wife</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;greater&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WilcoxonResult(statistic=92.0, pvalue=0.00537109375)
</pre></div>
</div>
</div>
</div>
<p><strong>d. Carry out a suitable permutation test test of the hypothesis that men own more socks than women</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">permutation_test</span><span class="p">((</span><span class="n">socks</span><span class="o">.</span><span class="n">Husband</span><span class="p">,</span> <span class="n">socks</span><span class="o">.</span><span class="n">Wife</span><span class="p">),</span> <span class="n">mDiff</span><span class="p">,</span> <span class="n">permutation_type</span><span class="o">=</span><span class="s1">&#39;samples&#39;</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;greater&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PermutationTestResult(statistic=4.571428571428571, pvalue=0.0059, null_distribution=array([ 1.28571429, -0.85714286,  1.85714286, ...,  0.71428571,
        1.28571429,  1.28571429]))
</pre></div>
</div>
</div>
</div>
<p><strong>e. Compare the two tests.</strong></p>
<p>In this case the rank-based test has a (slightly) smaller <span class="math notranslate nohighlight">\(p\)</span>-value than the permutation test.</p>
<p>The permutation test preserves thhe following features of the data:</p>
<ol class="arabic simple">
<li><p>In each couple one partner usually has more socks (what we shuffle is <em>which</em> partner this is)</p></li>
<li><p>One couple has an extreme difference in sock-counts (we shuffle whether it is the husband or wife who has more socks)</p></li>
<li><p>We retain the sample sizes and overall distribution of difference of means</p></li>
</ol>
<p>The rank-based test ‘neutralizes’ one of these features, which is it and what is the effect?</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./3.2_RankBasedTests"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-python-libraries">Set up Python libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#whose-peaches-are-heavier">1. Whose peaches are heavier?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#iq-and-vitamins">2. IQ and vitamins</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#socks">3. Socks</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>